<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ˜¥æ—¥åºæ›²ï½œä¹å·å±±æµ·è‡ªé§•æ—¥è¨˜ ğŸŒ¸</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;500;700&display=swap');

        :root {
            --plum: #F06292;        /* æ¢…èŠ±ä¸»è‰² */
            --plum-light: #FCE4EC;
            --ocean: #29B6F6;       /* æµ·æ´‹è— */
            --ocean-dark: #0277BD;
            --mountain: #9CCC65;    /* é˜¿è˜‡ç¶  */
            --text: #37474F;
            --glass: rgba(255, 255, 255, 0.95);
            --gift: #FF9800;        /* ä¼´æ‰‹ç¦®æ©˜ */
            --coupon: #E91E63;      /* å„ªæƒ åˆ¸ç´… */
            --res: #673AB7;         /* é ç´„æ†‘è­‰ç´« */
            --market: #4CAF50;      /* è¶…å¸‚ç¶  */
        }

        body {
            font-family: 'Zen Maru Gothic', sans-serif;
            background: linear-gradient(160deg, #E1F5FE 0%, #F3E5F5 50%, #F1F8E9 100%);
            margin: 0;
            padding: 20px;
            color: var(--text);
            min-height: 100vh;
            background-attachment: fixed;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            background: var(--glass);
            border-radius: 24px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            position: relative;
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255,255,255,0.6);
            padding-bottom: 30px;
        }

        /* --- Header --- */
        header {
            background-image: url('https://images.unsplash.com/photo-1522383225653-ed111181a951?q=80&w=2076&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
            height: 200px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        header::after {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(255,255,255,0.4);
            backdrop-filter: blur(1px);
        }

        .header-text {
            position: relative;
            z-index: 2;
            text-align: center;
        }

        h1 {
            margin: 0;
            font-size: 2rem;
            color: #D81B60;
            text-shadow: 2px 2px 4px rgba(255,255,255,0.9);
            letter-spacing: 3px;
            font-weight: 800;
        }

        /* Navigation Grid */
        .nav-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            padding: 20px;
        }

        .nav-btn {
            background: white;
            padding: 18px;
            border-radius: 16px;
            text-align: center;
            font-weight: bold;
            color: var(--text);
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
            border: 2px solid transparent;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .nav-btn:active {
            transform: scale(0.95);
            background-color: #f0f0f0;
        }

        .nav-btn i { font-size: 1.5rem; color: var(--plum); }

        /* Sections */
        .section { display: none; padding: 0 20px; animation: fadeIn 0.3s ease; }
        .section.active { display: block; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Back Button */
        .back-btn {
            background: white;
            border: 2px solid var(--ocean-dark);
            color: var(--ocean-dark);
            font-size: 0.95rem;
            font-weight: bold;
            cursor: pointer;
            margin: 15px 0;
            padding: 10px 20px;
            border-radius: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-family: inherit;
            box-shadow: 0 3px 6px rgba(0,0,0,0.1);
            width: 100%;
            box-sizing: border-box;
        }

        h2 {
            font-size: 1.4rem;
            color: var(--plum);
            border-bottom: 2px dashed #ddd;
            padding-bottom: 10px;
            margin-top: 0;
        }

        /* Collapsible Buttons */
        .collapse-btn {
            width: 100%;
            background: white;
            border: none;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 12px;
            text-align: left;
            font-family: inherit;
            font-size: 1.05rem;
            font-weight: bold;
            color: var(--text);
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: 0.2s;
        }
        
        /* Borders for categories */
        .date-btn { border-left: 5px solid var(--ocean); }
        .food-region-btn { border-left: 5px solid var(--plum); }
        .souvenir-btn { border-left: 5px solid var(--gift); }
        .res-btn { border-left: 5px solid var(--res); }
        .market-btn { border-left: 5px solid var(--market); }

        .collapse-btn.active { background: #fdf2f7; color: #D81B60; }
        
        .collapse-content { display: none; padding: 10px 5px; margin-bottom: 15px; }
        .collapse-content.open { display: block; animation: slideDown 0.3s ease; }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        /* Supermarket Items */
        .market-item {
            background: white;
            padding: 15px;
            margin-bottom: 12px;
            border-radius: 12px;
            border-left: 5px solid var(--market);
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
            cursor: pointer;
        }
        .market-name { font-weight: bold; font-size: 1.05rem; color: #2E7D32; display: block; margin-bottom: 5px; }
        .market-dist { font-size: 0.85rem; color: #FF5722; font-weight: bold; background: #FFEBEE; padding: 2px 6px; border-radius: 4px; margin-right: 5px; }
        .market-feature { font-size: 0.9rem; color: #555; margin-top: 5px; line-height: 1.4; }
        .market-item::after { content: '\f3c5'; font-family: "Font Awesome 5 Free"; font-weight: 900; position: absolute; right: 15px; top: 20px; color: var(--market); opacity: 0.5; }

        /* Souvenir & Coupon Items */
        .souvenir-item {
            background: white;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 12px;
            border-left: 5px solid var(--gift);
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
            cursor: pointer;
            position: relative;
        }
        .souvenir-name { font-weight: bold; font-size: 1.05rem; color: #333; }
        .souvenir-price { color: #D81B60; font-weight: bold; font-size: 0.9rem; margin-left: 8px; }
        .souvenir-loc { font-size: 0.85rem; color: #666; margin-top: 2px; }
        .souvenir-note { font-size: 0.8rem; color: #888; font-style: italic; }
        .souvenir-item::after { content: '\f3c5'; font-family: "Font Awesome 5 Free"; font-weight: 900; position: absolute; right: 15px; top: 50%; transform: translateY(-50%); color: var(--gift); opacity: 0.5; }

        .coupon-card {
            background: white; border-radius: 15px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.1); margin-bottom: 20px; border: 2px dashed var(--coupon); position: relative;
        }
        .coupon-card::before {
            content: 'COUPON'; position: absolute; top: 10px; right: 10px; background: var(--coupon); color: white; padding: 3px 8px; border-radius: 5px; font-size: 0.7rem; font-weight: bold; z-index: 2;
        }
        .coupon-img { width: 100%; height: 180px; object-fit: contain; background: #fafafa; display: block; }
        .coupon-info { padding: 15px; text-align: center; border-top: 1px solid #eee; }
        .coupon-title { font-weight: bold; font-size: 1.1rem; }

        /* Timeline & Steps */
        .timeline-step { display: flex; margin-bottom: 15px; padding-left: 10px; position: relative; }
        .timeline-step::before { content: ''; position: absolute; left: 0; top: 8px; bottom: -20px; width: 2px; background: #eee; }
        .timeline-step:last-child::before { display: none; }
        .step-time { font-size: 0.8rem; color: #999; width: 50px; flex-shrink: 0; padding-top: 3px; font-weight: bold; }
        .step-content { background: white; padding: 12px 15px; border-radius: 12px; flex-grow: 1; box-shadow: 0 2px 8px rgba(0,0,0,0.03); border-left: 4px solid var(--mountain); cursor: pointer; position: relative; }
        .step-content::after { content: 'ğŸ“¸'; font-size: 1rem; position: absolute; right: 10px; top: 12px; opacity: 0.6; }
        .res-content { border-left: 4px solid var(--res); }
        .res-content::after { content: 'ğŸ“„'; }

        /* Tags */
        .food-tag { background: white; padding: 10px 14px; border-radius: 20px; font-size: 0.95rem; margin: 0 6px 10px 0; display: inline-block; border: 1px solid #eee; cursor: pointer; border-left: 4px solid var(--plum); }
        
        /* Mapcode Table */
        .map-table { width: 100%; border-collapse: separate; border-spacing: 0 8px; }
        .map-table td { background: white; padding: 12px; border: 1px solid #eee; }
        .map-table td:first-child { border-radius: 10px 0 0 10px; }
        .map-table td:last-child { border-radius: 0 10px 10px 0; text-align: right; }
        .map-link { font-weight: bold; color: var(--ocean-dark); text-decoration: none; display: block; }
        .copy-btn { background: var(--plum-light); color: var(--plum); border: none; padding: 4px 10px; border-radius: 20px; font-size: 0.8rem; font-weight: bold; cursor: pointer; margin-left: 5px; }

        /* Calculator */
        .calc-card { background: white; padding: 20px; border-radius: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        .calc-input { width: 100%; padding: 12px; border: 2px solid #eee; border-radius: 12px; font-size: 1.2rem; box-sizing: border-box; }
        .calc-result { background: #fff0f5; padding: 20px; border-radius: 15px; margin-top: 10px; border: 2px solid var(--plum); text-align: center; }
        .twd-amount { font-size: 2.5rem; font-weight: 800; color: #D81B60; }

        /* Checklist */
        .checklist-item { background: white; padding: 12px; margin-bottom: 8px; border-radius: 10px; display: flex; align-items: center; border: 1px solid #f0f0f0; }
        .checklist-item input { margin-right: 15px; width: 20px; height: 20px; accent-color: var(--plum); }
        .checklist-item.checked span { text-decoration: line-through; color: #ccc; }

        /* Modal */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; justify-content: center; align-items: center; padding: 20px; box-sizing: border-box; backdrop-filter: blur(5px); }
        .modal.open { display: flex; }
        .modal-card { background: white; width: 100%; max-width: 400px; border-radius: 20px; overflow: hidden; position: relative; }
        .modal-img { width: 100%; height: auto; max-height: 50vh; object-fit: contain; background: #333; display: block; }
        .modal-body { padding: 20px; }
        .close-modal { position: absolute; top: 15px; right: 15px; background: rgba(0,0,0,0.5); color: white; border: none; width: 30px; height: 30px; border-radius: 50%; font-size: 1.2rem; cursor: pointer; }

        /* Tabs */
        .map-tabs { display: flex; background: #f0f0f0; border-radius: 10px; padding: 5px; margin-bottom: 20px; }
        .map-tab-btn { flex: 1; padding: 10px; border: none; background: transparent; cursor: pointer; font-weight: bold; color: #888; border-radius: 8px; }
        .map-tab-btn.active { background: white; color: var(--ocean-dark); box-shadow: 0 2px 5px rgba(0,0,0,0.1); }

    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>

    <div class="container">
        <header>
            <div class="header-text">
                <h1>æ˜¥æ—¥åºæ›²</h1>
            </div>
        </header>

        <div id="home" class="section active">
            <div class="nav-grid">
                <div class="nav-btn" onclick="showSection('itinerary')">
                    <i class="fas fa-map-marked-alt"></i> äº’å‹•è¡Œç¨‹è¡¨
                </div>
                <div class="nav-btn" onclick="showSection('packing')">
                    <i class="fas fa-suitcase"></i> æ—…è¡Œæ¸…å–®
                </div>
                <div class="nav-btn" onclick="showSection('food')">
                    <i class="fas fa-utensils"></i> ç¾é£Ÿåœ°åœ–
                </div>
                <div class="nav-btn" onclick="showSection('souvenirs')">
                    <i class="fas fa-gift"></i> ä¼´æ‰‹ç¦®æ¨è–¦
                </div>
                <div class="nav-btn" onclick="showSection('coupons')">
                    <i class="fas fa-ticket-alt"></i> å„ªæƒ åˆ¸
                </div>
                <div class="nav-btn" onclick="showSection('mapcodes')">
                    <i class="fas fa-car-side"></i> å°èˆªç·¨ç¢¼
                </div>
                <div class="nav-btn" onclick="showSection('reservations')">
                    <i class="fas fa-file-invoice"></i> é ç´„æ†‘è­‰
                </div>
                <div class="nav-btn" onclick="showSection('calculator')">
                    <i class="fas fa-calculator"></i> åŒ¯ç‡è¨ˆç®—
                </div>
                <div class="nav-btn" onclick="showSection('supermarkets')">
                    <i class="fas fa-shopping-basket"></i> ä½å®¿å‘¨é‚Šè¶…å¸‚
                </div>
            </div>
        </div>

        <div id="supermarkets" class="section">
            <button class="back-btn" onclick="showSection('home')"><i class="fas fa-chevron-left"></i> è¿”å›é¦–é </button>
            <h2>ğŸ›’ ä½å®¿å‘¨é‚Šè¶…å¸‚</h2>
            <div id="supermarket-container"></div>
        </div>

        <div id="coupons" class="section">
            <button class="back-btn" onclick="showSection('home')"><i class="fas fa-chevron-left"></i> è¿”å›é¦–é </button>
            <h2>ğŸŸï¸ å„ªæƒ åˆ¸å°ˆå€</h2>
            
            <div class="coupon-card">
                <img src="coupon_daikoku.jpg" class="coupon-img" onclick="openModal('å¤§åœ‹è—¥å¦', 'coupon_daikoku.jpg', 'çµå¸³è«‹å‡ºç¤º')" onerror="this.src='https://via.placeholder.com/300x150?text=åœ–ç‰‡è¼‰å…¥å¤±æ•—';">
                <div class="coupon-info"><div class="coupon-title">å¤§åœ‹è—¥å¦ (Daikoku)</div></div>
            </div>
            <div class="coupon-card">
                <img src="coupon_tsuruha.jpg" class="coupon-img" onclick="openModal('é¶´ç¾½è—¥å¦', 'coupon_tsuruha.jpg', 'çµå¸³è«‹å‡ºç¤º')" onerror="this.src='https://via.placeholder.com/300x150?text=åœ–ç‰‡è¼‰å…¥å¤±æ•—';">
                <div class="coupon-info"><div class="coupon-title">é¶´ç¾½è—¥å¦ (Tsuruha)</div></div>
            </div>
            <div class="coupon-card">
                <img src="coupon_matsukiyo.jpg" class="coupon-img" onclick="openModal('æ¾æœ¬æ¸…', 'coupon_matsukiyo.jpg', 'çµå¸³è«‹å‡ºç¤º')" onerror="this.src='https://via.placeholder.com/300x150?text=åœ–ç‰‡è¼‰å…¥å¤±æ•—';">
                <div class="coupon-info"><div class="coupon-title">æ¾æœ¬æ¸… (Matsumoto Kiyoshi)</div></div>
            </div>
            <div class="coupon-card">
                <img src="coupon_cosmos.jpg" class="coupon-img" onclick="openModal('Cosmos', 'coupon_cosmos.jpg', 'çµå¸³è«‹å‡ºç¤º')" onerror="this.src='https://via.placeholder.com/300x150?text=åœ–ç‰‡è¼‰å…¥å¤±æ•—';">
                <div class="coupon-info"><div class="coupon-title">Cosmos è—¥å¦</div></div>
            </div>
            <div class="coupon-card">
                <img src="coupon_bic.jpg" class="coupon-img" onclick="openModal('BicCamera', 'coupon_bic.jpg', 'çµå¸³è«‹å‡ºç¤º')" onerror="this.src='https://via.placeholder.com/300x150?text=åœ–ç‰‡è¼‰å…¥å¤±æ•—';">
                <div class="coupon-info"><div class="coupon-title">BicCamera</div></div>
            </div>
            <div class="coupon-card">
                <img src="coupon_donki.jpg" class="coupon-img" onclick="openModal('å”å‰è¨¶å¾·', 'coupon_donki.jpg', 'çµå¸³è«‹å‡ºç¤º')" onerror="this.src='https://via.placeholder.com/300x150?text=åœ–ç‰‡è¼‰å…¥å¤±æ•—';">
                <div class="coupon-info"><div class="coupon-title">å”å‰è¨¶å¾· (Don Quijote)</div></div>
            </div>
        </div>

        <div id="souvenirs" class="section">
            <button class="back-btn" onclick="showSection('home')"><i class="fas fa-chevron-left"></i> è¿”å›é¦–é </button>
            <h2>ğŸ å¿…è²·ä¼´æ‰‹ç¦®</h2>
            <div class="parking-card">
                <div class="parking-title"><i class="fas fa-parking"></i> åšå¤šè»Šç«™ä¸­å¤®åœè»Šå ´</div>
                <div class="parking-info">
                    <div>MapCode: <b>13 320 354*52</b> <button class="copy-btn" onclick="copy('13 320 354*52')">è¤‡è£½</button></div>
                    <div style="margin-top:5px; color:#888;">å„ªæƒ ï¼šæ»¿3000æ—¥åœ“æŠµ1å°æ™‚</div>
                    <div style="margin-top:5px; text-align:right;">
                        <span class="map-link" onclick="openGoogleMap('åšå¤šé§…ä¸­å¤®é§è»Šå ´')" style="cursor:pointer; color:#e65100;">
                            Google Map å°èˆª <i class="fas fa-location-arrow"></i>
                        </span>
                    </div>
                </div>
            </div>
            <div id="souvenir-container"></div>
        </div>

        <div id="packing" class="section">
            <button class="back-btn" onclick="showSection('home')"><i class="fas fa-chevron-left"></i> è¿”å›é¦–é </button>
            <h2>ğŸ’ å‡ºç™¼å‰æª¢æŸ¥</h2>
            <div id="checklist-container"></div>
        </div>

        <div id="calculator" class="section">
            <button class="back-btn" onclick="showSection('home')"><i class="fas fa-chevron-left"></i> è¿”å›é¦–é </button>
            <h2>ğŸ’´ è³¼ç‰©è¨ˆç®—æ©Ÿ</h2>
            <div class="calc-card">
                <div style="margin-bottom:20px; text-align:left;">
                    <label style="color:#888; font-size:0.9rem;">åŒ¯ç‡ (å¯ä¿®æ”¹)</label>
                    <input type="number" id="rate-input" class="calc-input" value="0.22" step="0.001" style="width:80px; padding:5px;">
                </div>
                <div style="margin-bottom:20px; text-align:left;">
                    <label style="color:#888; font-size:0.9rem;">æ—¥å¹£é‡‘é¡ (Â¥)</label>
                    <input type="number" id="jpy-input" class="calc-input" placeholder="è¼¸å…¥åƒ¹æ ¼...">
                </div>
                <div class="calc-result">
                    <div style="font-size:0.9rem; color:#666;">ç´„åˆå°å¹£ (TWD)</div>
                    <div class="twd-amount" id="twd-output">0</div>
                </div>
            </div>
        </div>

        <div id="itinerary" class="section">
            <button class="back-btn" onclick="showSection('home')"><i class="fas fa-chevron-left"></i> è¿”å›é¦–é </button>
            <h2>ğŸ“… æ¯æ—¥è¡Œç¨‹</h2>
            <div id="itinerary-content"></div>
        </div>

        <div id="food" class="section">
            <button class="back-btn" onclick="showSection('home')"><i class="fas fa-chevron-left"></i> è¿”å›é¦–é </button>
            <h2>ğŸœ ç¾é£Ÿåœ°åœ–</h2>
            <div id="food-container"></div>
        </div>

        <div id="mapcodes" class="section">
            <button class="back-btn" onclick="showSection('home')"><i class="fas fa-chevron-left"></i> è¿”å›é¦–é </button>
            <h2>ğŸš— å°èˆªç·¨ç¢¼</h2>
            <div class="map-tabs">
                <button class="map-tab-btn active" onclick="switchMapTab(1)">å±±æ—ç¯‡</button>
                <button class="map-tab-btn" onclick="switchMapTab(2)">æµ·æ´‹ç¯‡</button>
            </div>
            <div id="map-page-1"><table class="map-table"><tbody id="map-body-1"></tbody></table></div>
            <div id="map-page-2" style="display:none;"><table class="map-table"><tbody id="map-body-2"></tbody></table></div>
        </div>

        <div id="reservations" class="section">
            <button class="back-btn" onclick="showSection('home')"><i class="fas fa-chevron-left"></i> è¿”å›é¦–é </button>
            <h2>ğŸ« é ç´„æ†‘è­‰</h2>
            <button class="collapse-btn res-btn" onclick="toggleAccordion(0, 'res-hotel', 'res-btn')"><span>ğŸ¨ ä½å®¿æ†‘è­‰</span><i class="fas fa-chevron-down"></i></button>
            <div id="res-hotel-0" class="collapse-content res-hotel"></div>
            
            <button class="collapse-btn res-btn" onclick="toggleAccordion(1, 'res-other', 'res-btn')"><span>ğŸ« äº¤é€šèˆ‡æ´»å‹•</span><i class="fas fa-chevron-down"></i></button>
            <div id="res-other-1" class="collapse-content res-other"></div>
        </div>
    </div>

    <div id="location-modal" class="modal" onclick="closeModal(event)">
        <div class="modal-card">
            <button class="close-modal" onclick="closeModal(event)">Ã—</button>
            <img id="modal-img" class="modal-img" src="">
            <div class="modal-body">
                <h3 id="modal-title"></h3>
                <p id="modal-desc" style="color:#666;"></p>
            </div>
        </div>
    </div>

<script>
    // --- 1. Global Helper: Google Maps ---
    function openGoogleMap(query) {
        // ä½¿ç”¨ Google Maps æ¨™æº–æœå°‹æ ¼å¼
        window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(query)}`, '_blank');
    }

    // --- 2. Data Definitions ---
    
    // Supermarket Data
    const supermarketData = [
        {
            hotel: "ğŸ¨ ä½å®¿1: ä¸‰äº•èŠ±åœ’ä¸­æ´²",
            shops: [
                { name: "Reganet Cute ä¸­æ´²å·ç«¯åº—", addr: "ç¦å²¡å¸‚åšå¤šåŒºä¸Šå·ç«¯ç”º 12-20", dist: "æ­¥è¡Œ 2 åˆ†", feat: "åœ°éµå…±æ§‹ï¼Œå›é£¯åº—é †è·¯" },
                { name: "Foodway ä¸­æ´²é£Ÿå°ç”ºåº—", addr: "ç¦å²¡å¸‚åšå¤šåŒºä¸­æ´² 3-7-24", dist: "æ­¥è¡Œ 3 åˆ†", feat: "Gate'så¤§æ¨“å…§ï¼Œé–‹å¾ˆæ™š" },
                { name: "Don Quijote å”å‰è¨¶å¾· ä¸­æ´²åº—", addr: "ç¦å²¡å¸‚åšå¤šåŒºä¸­æ´² 3-7-24", dist: "æ­¥è¡Œ 3 åˆ†", feat: "24Hï¼Œé›¶é£Ÿé›œè²¨å…¨æœ‰" },
                { name: "MaxValu Express åšå¤šç¥‡åœ’åº—", addr: "ç¦å²¡å¸‚åšå¤šåŒºç¥‡åœ’ç”º 7-20", dist: "æ­¥è¡Œ 10 åˆ†", feat: "24H æ¨™æº–è¶…å¸‚" },
                { name: "å¤§ä¸¸ç¦å²¡å¤©ç¥åº— åœ°ä¸‹é£Ÿå“è¡—", addr: "ç¦å²¡å¸‚ä¸­å¤®åŒºå¤©ç¥ 1-4-1", dist: "æ­¥è¡Œ 8 åˆ†", feat: "é«˜ç´šæ°´æœã€å’Œç‰›" }
            ]
        },
        {
            hotel: "ğŸ¨ ä½å®¿2: è¥¿éµ Croom ç¥‡åœ’",
            shops: [
                { name: "MaxValu Express åšå¤šç¥‡åœ’åº—", addr: "ç¦å²¡å¸‚åšå¤šåŒºç¥‡åœ’ç”º 7-20", dist: "æ­¥è¡Œ 3 åˆ†", feat: "é£¯åº—æ–œå°é¢ï¼Œ24Hæœ€æ–¹ä¾¿" },
                { name: "Lopia åšå¤šYodobashiåº—", addr: "ç¦å²¡å¸‚åšå¤šåŒºåšå¤šé§…ä¸­å¤®è¡— 6-12", dist: "æ­¥è¡Œ 12 åˆ†", feat: "é«˜CPå€¼ï¼Œè‚‰ä¾¿å®œ (åªæ”¶ç¾é‡‘)" },
                { name: "åšå¤šé˜ªæ€¥ åœ°ä¸‹é£Ÿå“è¡—", addr: "ç¦å²¡å¸‚åšå¤šåŒºåšå¤šé§…ä¸­å¤®è¡— 1-1", dist: "æ­¥è¡Œ 10 åˆ†", feat: "é«˜ç´šç†Ÿé£Ÿä¾¿ç•¶" },
                { name: "Bon Repas ç™¾æ—¬é¤¨", addr: "ç¦å²¡å¸‚ä¸­å¤®åŒºæ¸¡è¾ºé€š 4-6-20", dist: "æ­¥è¡Œ 15 åˆ†", feat: "åœ¨åœ°é«˜ç´šè¶…å¸‚" }
            ]
        },
        {
            hotel: "ğŸ¨ ä½å®¿3: Dormy Inn ç†Šæœ¬",
            shops: [
                { name: "Foodway SAKURA MACHIåº—", addr: "ç†Šæœ¬å¸‚ä¸­å¤®åŒºæ¡œç”º 3-10", dist: "æ­¥è¡Œ 2 åˆ†", feat: "é£¯åº—å°é¢åœ°ä¸‹1æ¨“ï¼Œæ–°ç©" },
                { name: "æ¥­å‹™è¶…å¸‚ è¾›å³¶å…¬åœ’åº—", addr: "ç†Šæœ¬å¸‚ä¸­å¤®åŒºè¾›å³¶ç”º 2-1", dist: "æ­¥è¡Œ 1 åˆ†", feat: "å¤§åŒ…è£é›¶é£Ÿä¾¿å®œ" },
                { name: "Miyahara ä¸‹é€šåº—", addr: "ç†Šæœ¬å¸‚ä¸­å¤®åŒºèŠ±ç•‘ç”º 11-14", dist: "æ­¥è¡Œ 5 åˆ†", feat: "åƒè¶…å•†çš„ç”Ÿé®®è¶…å¸‚" },
                { name: "Don Quijote ç†Šæœ¬ä¸‹é€šåº—", addr: "ç†Šæœ¬å¸‚ä¸­å¤®åŒºå®‰æ”¿ç”º 5-27", dist: "æ­¥è¡Œ 6 åˆ†", feat: "24H è£œè²¨é¦–é¸" },
                { name: "é¶´å±‹ç™¾è²¨åº— åœ°ä¸‹é£Ÿå“è¡—", addr: "ç†Šæœ¬å¸‚ä¸­å¤®åŒºæ‰‹å–æœ¬ç”º 6-1", dist: "æ­¥è¡Œ 10 åˆ†", feat: "ç†Šæœ¬æœ€é«˜ç´šç™¾è²¨" }
            ]
        }
    ];

    // Souvenir Data
    const souvenirData = [
        {
            category: "ğŸ§‚ èª¿å‘³æ–™ / é¹¹é£Ÿé¡",
            items: [
                { name: "è»Ÿç®¡æ˜å¤ªå­é†¬", price: "Â¥756", loc: "Maing ååº—è¡—", note: "é…é£¯ç¥ç‰©" },
                { name: "èŒ…ä¹ƒèˆé«˜æ¹¯åŒ…", price: "Â¥2,268", loc: "Deitos 1F", note: "é€ç¦®é¦–é¸" },
                { name: "æ˜å¤ªå­ä»™è²", price: "Â¥540", loc: "Maing", note: "ç¶“å…¸é¹¹é£Ÿ" },
                { name: "é’æŸšå­èƒ¡æ¤’", price: "Â¥432", loc: "Maing", note: "æ²¾è‚‰çµ•é…" },
                { name: "Calbee æ˜å¤ªå­è–¯æ¢", price: "Â¥900", loc: "Maing", note: "åˆ†é£Ÿæ–¹ä¾¿" },
                { name: "å…«å¥³èŒ¶", price: "Â¥1,080", loc: "Maing", note: "é«˜ç´šç¶ èŒ¶" }
            ]
        },
        {
            category: "ğŸ° ç”œé» / è›‹ç³•é¡",
            items: [
                { name: "ç¦ç ‚å±‹ é•·å´è›‹ç³•", price: "Â¥1,458", loc: "Maing", note: "åº•éƒ¨ç²—ç³–" },
                { name: "åšå¤šé€šé¥…é ­", price: "Â¥730", loc: "Maing", note: "å¥¶é¦™æ¿ƒéƒ" },
                { name: "Sugar Butter Sand Tree", price: "Â¥993", loc: "åšå¤šé˜ªæ€¥ B1F", note: "ç”˜ç‹è‰è“å£å‘³" },
                { name: "ä¼Šéƒ½ King è‰è“éŠ…é‘¼ç‡’", price: "Â¥565", loc: "Maing", note: "å«æ•´é¡†è‰è“" },
                { name: "å—è »å¾€ä¾†", price: "Â¥670", loc: "Maing", note: "é…¥è„†æä»" },
                { name: "ç­‘ç´«éº»ç³¬", price: "Â¥540", loc: "Maing", note: "é™„é»‘ç³–èœœ" },
                { name: "æ²»ä¸€éƒå¸ƒä¸", price: "Â¥420", loc: "JRåšå¤šåŸ 1F", note: "è›‹é¦™æ¿ƒéƒ" }
            ]
        },
        {
            category: "ğŸª é¤…ä¹¾ / å°é»å¿ƒ",
            items: [
                { name: "äºŒâ—‹åŠ ç…é¤…", price: "Â¥648", loc: "Maing", note: "é™„æç¬‘é¢å…·" },
                { name: "Tirolian æ²å¿ƒé…¥", price: "Â¥540", loc: "Maing", note: "å¾©å¤éµç½" },
                { name: "åšå¤šç”œè–¯ç‡’", price: "Â¥648", loc: "Maing", note: "ç¶¿å¯†åœ°ç“œ" },
                { name: "åšå¤šç´…è‰è“é¤…ä¹¾", price: "Â¥777", loc: "Maing", note: "è‰è“å¤¾å¿ƒ" },
                { name: "å°é›é¥…é ­", price: "Â¥1,194", loc: "Maing", note: "ç¶“å…¸" },
                { name: "åšå¤šä¹‹å¥³", price: "Â¥389", loc: "Maing", note: "å¹´è¼ªè›‹ç³•" }
            ]
        }
    ];

    // Itinerary
    const itineraryData = [
        { date: "1/29 (å››) Day 1", steps: [
            { t: "12:00", name: "ç¦å²¡æ©Ÿå ´æŠµé”", image: "day1_airport.jpg", desc: "CI138 æŠµé”" },
            { t: "14:00", name: "å·ç«¯é€šå•†åº—è¡—", image: "day1_kawabata.jpg", desc: "å¤è€å•†åº—è¡—" },
            { t: "15:00", name: "Full Full æ˜å¤ªå­éºµåŒ…", image: "day1_fullfull.jpg", desc: "å¿…åƒæ³•æ£" },
            { t: "18:00", name: "è—¥é™¢ç‡’è‚‰ NIKUICHI", image: "day1_nikuichi.jpg", desc: "å·²é ç´„ CPå€¼é«˜" },
            { t: "20:00", name: "è¥¿éµ Croom åšå¤šç¥‡åœ’", image: "day1_hotel.jpg", desc: "å¤§æµ´å ´" }
        ]},
        { date: "1/30 (äº”) Day 2", steps: [
            { t: "10:35", name: "åšå¤šåŸ é ­æ­èˆ¹", image: "day2_ferry.jpg", desc: "å¾€æµ·ä¹‹ä¸­é“" },
            { t: "11:00", name: "æµ·ä¹‹ä¸­é“æµ·æ¿±å…¬åœ’", image: "day2_park.jpg", desc: "é¨è…³è¸è»Š" },
            { t: "18:00", name: "åšå¤šé‹æ²³åŸ", image: "day2_canalcity.jpg", desc: "æ°´èˆç§€" }
        ]},
        { date: "1/31 (å…­) Day 3", steps: [
            { t: "09:00", name: "Toyota Rent a Car", image: "day3_car.jpg", desc: "åšå¤šç«™æ±å–è»Š" },
            { t: "11:30", name: "ULUU è‰è“åƒåˆ°é£½", image: "day3_strawberry.jpg", desc: "ä½è³€" },
            { t: "15:00", name: "ç”±å¸ƒé™¢ æ¹¯ä¹‹åª", image: "day3_yufuin.jpg", desc: "ç«¥è©±æ‘" },
            { t: "18:30", name: "æ¹¯å¸ƒé™¢å±±æ°´é¤¨", image: "day3_sansuikan.jpg", desc: "éœ²å¤©æº«æ³‰" }
        ]},
        { date: "2/1 (æ—¥) Day 4", steps: [
            { t: "08:00", name: "é‡‘é±—æ¹–", image: "day4_lake.jpg", desc: "æ™¨éœ§" },
            { t: "11:00", name: "é˜¿è˜‡è‰åƒé‡Œ", image: "day4_kusasenri.jpg", desc: "ç«å±±æ™¯è§€" },
            { t: "13:00", name: "é˜¿è˜‡èµ¤ç‰›ä¸¼", image: "day4_beef.jpg", desc: "Imakiné£Ÿå ‚" },
            { t: "19:00", name: "Dormy Inn ç†Šæœ¬", image: "day4_dormy.jpg", desc: "å…è²»æ‹‰éºµ" }
        ]},
        { date: "2/2 (ä¸€) Day 5", steps: [
            { t: "11:30", name: "å¤©è‰æµ·é®®è”µ", image: "day5_dolphin.jpg", desc: "çœ‹æµ·è±š + BBQ" },
            { t: "18:00", name: "ç†Šæœ¬ä¸‹é€šå•†åº—è¡—", image: "day5_shopping.jpg", desc: "é€›è¡—" }
        ]},
        { date: "2/3 (äºŒ) Day 6", steps: [
            { t: "10:00", name: "ç†Šæœ¬åŸ", image: "day6_castle.jpg", desc: "å¤©å®ˆé–£" },
            { t: "15:00", name: "å¤ªå®°åºœå¤©æ»¿å®®", image: "day6_dazaifu.jpg", desc: "æ¢…æé¤…" },
            { t: "19:00", name: "ä¸‰äº•èŠ±åœ’ä¸­æ´²", image: "day6_hotel.jpg", desc: "è³ªæ„Ÿé£¯åº—" }
        ]},
        { date: "2/4 (ä¸‰) Day 7", steps: [
            { t: "09:00", name: "å‘¼å­æœå¸‚", image: "day7_squid.jpg", desc: "æ´»èŠ±æ" },
            { t: "14:00", name: "ç³¸å³¶ å¤«å©¦å²©", image: "day7_itoshima.jpg", desc: "ç™½è‰²é³¥å±…" }
        ]},
        { date: "2/5 (å››) Day 8", steps: [
            { t: "All Day", name: "THE OUTLETS", image: "day8_outlets.jpg", desc: "åŒ—ä¹å·æœ€å¤§" },
            { t: "18:00", name: "é‚„è»Š", image: "day8_returncar.jpg", desc: "åšå¤šç«™æ±" }
        ]},
        { date: "2/6 (äº”) Day 9", steps: [
            { t: "ä¸Šåˆ", name: "å‰å¾€æ©Ÿå ´", image: "day9_home.jpg", desc: "CI139 å›å®¶" }
        ]}
    ];

    // Food
    const foodData = [
        { region: "åšå¤š", items: ["Full Full æ˜å¤ªå­éºµåŒ…", "è—¥é™¢ç‡’è‚‰ NIKUICHI", "ä¸€é›™æ‹‰éºµ", "å‰å¡šé°»é­šå±‹", "åŠªåŠªé›", "åšå¤šä¸€å£é¤ƒå­"] },
        { region: "å¤©ç¥", items: ["I'm donut?", "Shin Shin æ‹‰éºµ", "è‘«è˜†å£½å¸", "å…ƒç¥–åšå¤šã‚ã‚“ãŸã„é‡", "å£½å¸éƒ", "æ•˜æ•˜è‹‘ éŠç„äº­", "BAKE CHEESE TART"] },
        { region: "ç”±å¸ƒé™¢", items: ["B-Speak è›‹ç³•æ²", "è±å¾Œç‰›å¯æ¨‚é¤…", "é‡œé£¯å¿ƒ", "Milch èµ·å¸è›‹ç³•", "èŠ±éº´èŠå®¶", "é‡‘è³å¯æ¨‚é¤…"] },
        { region: "ç†Šæœ¬", items: ["é»‘äº­æ‹‰éºµ", "å‹çƒˆäº­ç‚¸è±¬æ’", "èœ‚æ¨‚é¥…é ­", "è…ä¹ƒå±‹ é¦¬è‚‰", "ç´…è˜­äº­ å¤ªå¹³ç‡•", "èŠ¥æœ«è“®è—•"] },
        { region: "é˜¿è˜‡/ä½è³€", items: ["Imakin èµ¤ç‰›ä¸¼", "æ²³å¤ªéƒ æ´»èŠ±æ", "ç³¸å³¶å¸ƒä¸", "é˜¿è˜‡ã¨ã‚Šå®®", "ä½è³€ç‰› å­£æ¨‚", "å¬‰é‡æ¹¯è±†è…"] }
    ];

    // Mapcodes (Updated Address for ULUU & Toyota)
    const mapcodeData = [
        { n: "Toyota Rent a Car (åšå¤šç«™æ±)", c: "13 320 188*71", p: "092-472-8388", addr: "1 Chome-4-10 Toko, Hakata Ward, Fukuoka, 812-0008" },
        { n: "Uluu Gardens SAGA (è‰è“åœ’)", c: "37 491 662*13", p: "080-8956-1030", addr: "Uluu Gardens SAGA ä½è³€çœŒä¸‰é¤ŠåŸºéƒ¡ã¿ã‚„ãç”ºæ±Ÿå£7079" },
        { n: "æ¹¯å¸ƒé™¢å±±æ°´é¤¨", c: "269 328 633*45", p: "0977-84-2101", addr: "Yufuin Sansuikan" },
        { n: "é‡‘é±—æ¹–åœè»Šå ´", c: "269 359 583*03", p: "0977-84-3111", addr: "Kinrin Lake Parking" },
        { n: "é˜¿è˜‡è‰åƒé‡Œ", c: "256 456 770*85", p: "0967-34-0131", addr: "Kusasenri Observatory" },
        { n: "é˜¿è˜‡ä¸­å²³ç«å±±å£", c: "256 458 600*30", p: "0967-34-1600", addr: "Mount Aso Nakadake Crater" }, 
        { n: "Imakin é£Ÿå ‚", c: "256 685 024*41", p: "0967-32-0031", addr: "Imakin Shokudo" },
        { n: "Dormy Inn ç†Šæœ¬", c: "29 459 468*88", p: "096-311-5489", addr: "Dormy Inn Kumamoto Natural Hot Spring" },
        { n: "å¤©è‰æµ·é®®è”µ", c: "474 084 158*44", p: "0969-52-7707", addr: "Amakusa Kaisenkura" },
        { n: "ç†Šæœ¬åŸ", c: "29 459 342*58", p: "096-352-5900", addr: "Kumamoto Castle" },
        { n: "å¤ªå®°åºœå¤©æ»¿å®®", c: "55 364 128*71", p: "092-922-8225", addr: "Dazaifu Tenmangu" },
        { n: "å‘¼å­æœå¸‚", c: "182 722 104*50", p: "0955-82-3426", addr: "Yobuko Morning Market" },
        { n: "ç³¸å³¶ å¤«å©¦å²©", c: "224 788 206*25", p: "092-327-0317", addr: "Sakurai Futamigaura of Itoshima" },
        { n: "THE OUTLETS", c: "16 427 590*78", p: "093-663-7251", addr: "THE OUTLETS KITAKYUSHU" }
    ];

    // Reservations
    const hotelRes = [
        { t: "åšå¤šé£¯åº— (è¥¿éµ)", d: "1/29 - 1/31", image: "res_hotel_hakata.jpg" },
        { t: "ç”±å¸ƒé™¢é£¯åº— (å±±æ°´é¤¨)", d: "1/31", image: "res_hotel_yufuin.jpg" },
        { t: "ç†Šæœ¬é£¯åº— (Dormy)", d: "2/1 - 2/3", image: "res_hotel_kumamoto.jpg" },
        { t: "ä¸­æ´²é£¯åº— (ä¸‰äº•)", d: "2/3 - 2/6", image: "res_hotel_nakasu.jpg" }
    ];
    const otherRes = [
        { t: "âœˆï¸ æ©Ÿç¥¨ (è¯èˆª)", d: "1/29 & 2/6", image: "res_flight.jpg" },
        { t: "ğŸš— ç§Ÿè»Š (Toyota)", d: "1/31 - 2/5", image: "res_car.jpg" },
        { t: "ğŸ“ è‰è“åƒåˆ°é£½", d: "1/31 11:30", image: "res_strawberry.jpg" },
        { t: "ğŸ¥© è—¥é™¢ç‡’è‚‰", d: "1/29 æ™šé¤", image: "res_yakiniku.jpg" },
        { t: "ğŸ¬ å¤©è‰æµ·è±š", d: "2/2 11:30", image: "res_dolphin.jpg" }
    ];

    // --- 3. Rendering Functions ---

    function showSection(id) {
        document.querySelectorAll('.section').forEach(el => el.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        window.scrollTo(0, 0);
    }

    function toggleAccordion(idx, className, btnClass) {
        const content = document.getElementById(`${className}-${idx}`);
        const btn = document.getElementsByClassName(btnClass)[idx];
        const isOpen = content.classList.contains('open');
        
        document.querySelectorAll('.' + className).forEach(e => e.classList.remove('open'));
        document.querySelectorAll('.' + btnClass).forEach(e => e.classList.remove('active'));

        if(!isOpen) {
            content.classList.add('open');
            btn.classList.add('active');
        }
    }

    // Render Supermarkets
    const marketContainer = document.getElementById('supermarket-container');
    supermarketData.forEach((grp, idx) => {
        const btn = document.createElement('button');
        btn.className = 'collapse-btn market-btn';
        btn.innerHTML = `<span>${grp.hotel}</span> <i class="fas fa-chevron-down"></i>`;
        btn.onclick = () => toggleAccordion(idx, 'market-list', 'market-btn');
        marketContainer.appendChild(btn);

        const div = document.createElement('div');
        div.id = `market-list-${idx}`;
        div.className = 'collapse-content market-list';
        grp.shops.forEach(shop => {
            const item = document.createElement('div');
            item.className = 'market-item';
            item.onclick = () => openGoogleMap(shop.addr);
            item.innerHTML = `<span class="market-name">${shop.name}</span><span class="market-dist">${shop.dist}</span><div class="market-feature">${shop.feat}</div>`;
            div.appendChild(item);
        });
        marketContainer.appendChild(div);
    });

    // Render Souvenirs
    const souvenirContainer = document.getElementById('souvenir-container');
    souvenirData.forEach((cat, idx) => {
        const btn = document.createElement('button');
        btn.className = 'collapse-btn souvenir-btn';
        btn.innerHTML = `<span>${cat.category}</span> <i class="fas fa-chevron-down"></i>`;
        btn.onclick = () => toggleAccordion(idx, 'souvenir-list', 'souvenir-btn');
        souvenirContainer.appendChild(btn);

        const div = document.createElement('div');
        div.id = `souvenir-list-${idx}`;
        div.className = 'collapse-content souvenir-list';
        cat.items.forEach(item => {
            const el = document.createElement('div');
            el.className = 'souvenir-item';
            el.onclick = () => openGoogleMap(`åšå¤šé§… ${item.loc} ${item.name.split('(')[0]}`);
            el.innerHTML = `<div><span class="souvenir-name">${item.name}</span><span class="souvenir-price">${item.price}</span></div><div class="souvenir-loc">${item.loc}</div><div class="souvenir-note">${item.note}</div>`;
            div.appendChild(el);
        });
        souvenirContainer.appendChild(div);
    });

    // Render Itinerary
    const itinDiv = document.getElementById('itinerary-content');
    itineraryData.forEach((day, idx) => {
        const btn = document.createElement('button');
        btn.className = 'collapse-btn date-btn';
        btn.innerHTML = `<span>${day.date}</span> <i class="fas fa-chevron-down"></i>`;
        btn.onclick = () => toggleAccordion(idx, 'day-details', 'date-btn');
        itinDiv.appendChild(btn);

        const div = document.createElement('div');
        div.id = `day-details-${idx}`;
        div.className = 'collapse-content day-details';
        day.steps.forEach(s => {
            const step = document.createElement('div');
            step.className = 'timeline-step';
            step.innerHTML = `<div class="step-time">${s.t}</div><div class="step-content" onclick="openModal('${s.name}', '${s.image}', '${s.desc}')"><div style="font-weight:bold;color:var(--text)">${s.name}</div><div style="font-size:0.85rem;color:#666;">${s.desc}</div></div>`;
            div.appendChild(step);
        });
        itinDiv.appendChild(div);
    });

    // Render Food
    const foodDiv = document.getElementById('food-container');
    foodData.forEach((cat, idx) => {
        const btn = document.createElement('button');
        btn.className = 'collapse-btn food-region-btn';
        btn.innerHTML = `<span>${cat.region}</span> <i class="fas fa-chevron-down"></i>`;
        btn.onclick = () => toggleAccordion(idx, 'food-list', 'food-region-btn');
        foodDiv.appendChild(btn);

        const div = document.createElement('div');
        div.id = `food-list-${idx}`;
        div.className = 'collapse-content food-list';
        cat.items.forEach(i => {
            const name = i.split('(')[0];
            div.innerHTML += `<span class="food-tag" onclick="openGoogleMap('${cat.region} ${name}')">${i} <i class="fas fa-location-arrow"></i></span>`;
        });
        foodDiv.appendChild(div);
    });

    // Render Reservations
    function renderRes(data, id) {
        const div = document.getElementById(id);
        data.forEach(r => {
            const el = document.createElement('div');
            el.className = 'step-content res-content';
            el.style.marginBottom = '10px';
            el.onclick = () => openModal(r.t, r.image, r.d);
            el.innerHTML = `<div style="font-weight:bold;color:var(--res)">${r.t}</div><div style="font-size:0.9rem;color:#555;">${r.d}</div>`;
            div.appendChild(el);
        });
    }
    renderRes(hotelRes, 'res-hotel-0');
    renderRes(otherRes, 'res-other-1');

    // Render Mapcodes
    const mapPart1 = mapcodeData.slice(0, 6);
    const mapPart2 = mapcodeData.slice(6);
    
    function renderMaps(data, id) {
        const tbody = document.getElementById(id);
        data.forEach(m => {
            const tr = document.createElement('tr');
            tr.innerHTML = `<td><span class="map-link" onclick="openGoogleMap('${m.addr}')" style="cursor:pointer">${m.n} <i class="fas fa-external-link-alt"></i></span></td><td><div style="font-weight:bold;color:var(--ocean-dark)">${m.c} <button class="copy-btn" onclick="copy('${m.c}')">è¤‡è£½</button></div><div style="font-size:0.85rem;color:#666">${m.p} <button class="copy-btn" onclick="copy('${m.p}')">è¤‡è£½</button></div></td>`;
            tbody.appendChild(tr);
        });
    }
    renderMaps(mapPart1, 'map-body-1');
    renderMaps(mapPart2, 'map-body-2');

    function switchMapTab(p) {
        document.querySelectorAll('.map-tab-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.map-tab-btn')[p-1].classList.add('active');
        document.getElementById('map-page-1').style.display = p===1 ? 'block' : 'none';
        document.getElementById('map-page-2').style.display = p===2 ? 'block' : 'none';
    }

    // Checklist
    const packDiv = document.getElementById('checklist-container');
    const packingList = ["è­·ç…§", "é§•ç…§+è­¯æœ¬", "ä¿¡ç”¨å¡(å¯Œé‚¦J)", "æ—¥å¹£", "æ‰‹æ©Ÿ+å……é›»å™¨", "è¡Œå‹•é›»æº", "eSIM", "ä¿æº«ç“¶", "ç‰™åˆ·", "é›¨å…·"];
    packingList.forEach((item, idx) => {
        const div = document.createElement('div');
        div.className = 'checklist-item';
        if(localStorage.getItem('pack_'+idx) === 'true') div.classList.add('checked');
        div.innerHTML = `<input type="checkbox" ${div.classList.contains('checked')?'checked':''} onchange="toggleCheck(this,${idx})"><span>${item}</span>`;
        packDiv.appendChild(div);
    });
    function toggleCheck(el, idx) {
        el.parentElement.classList.toggle('checked');
        localStorage.setItem('pack_'+idx, el.checked);
    }

    // Modal
    const modal = document.getElementById('location-modal');
    function openModal(t, src, d) {
        document.getElementById('modal-title').innerText = t;
        document.getElementById('modal-desc').innerText = d;
        document.getElementById('modal-img').src = src;
        modal.classList.add('open');
    }
    function closeModal(e) {
        if(e.target === modal || e.target.classList.contains('close-modal')) modal.classList.remove('open');
    }

    // Calculator
    const jpyIn = document.getElementById('jpy-input');
    const rateIn = document.getElementById('rate-input');
    const twdOut = document.getElementById('twd-output');
    function calc() {
        twdOut.innerText = Math.round((parseFloat(jpyIn.value)||0) * (parseFloat(rateIn.value)||0)).toLocaleString();
    }
    if(jpyIn) {
        jpyIn.addEventListener('input', calc);
        rateIn.addEventListener('input', calc);
        fetch('https://api.exchangerate-api.com/v4/latest/JPY').then(r=>r.json()).then(d=>{ if(d.rates.TWD) { rateIn.value=d.rates.TWD; calc(); }});
    }

    function copy(txt) { navigator.clipboard.writeText(txt).then(() => alert('å·²è¤‡è£½: '+txt)); }
</script>
</body>
</html>
